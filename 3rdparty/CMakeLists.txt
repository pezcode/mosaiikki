# glfw

set(GLFW_BUILD_EXAMPLES OFF CACHE BOOL "" FORCE)
set(GLFW_BUILD_TESTS OFF CACHE BOOL "" FORCE)
set(GLFW_BUILD_DOCS OFF CACHE BOOL "" FORCE)
set(GLFW_INSTALL OFF CACHE BOOL "" FORCE)
add_subdirectory(glfw EXCLUDE_FROM_ALL)

# glslang

if(SHADER_VALIDATION)
    # if we don't do this, CMake will complain that Glslang::Glslang depends on
    # a non-existent path <project>/build/include in INTERFACE_INCLUDE_DIRECTORIES
    # glslang only creates this directory later at build time
    file(MAKE_DIRECTORY "${CMAKE_BINARY_DIR}/include")

    set(BUILD_TESTING OFF CACHE BOOL "" FORCE)
    set(BUILD_EXTERNAL OFF CACHE BOOL "" FORCE)
    set(ENABLE_CTEST OFF CACHE BOOL "" FORCE)
    set(ENABLE_GLSLANG_BINARIES OFF CACHE BOOL "" FORCE)
    set(ENABLE_OPT OFF CACHE BOOL "" FORCE)
    set(ENABLE_HLSL OFF CACHE BOOL "" FORCE)
    set(ENABLE_SPVREMAPPER OFF CACHE BOOL "" FORCE)
    add_subdirectory(glslang EXCLUDE_FROM_ALL)
endif()

# Corrade and Magnum settings

set(BUILD_DEPRECATED OFF CACHE BOOL "" FORCE)

if(NOT BUILD_SHARED_LIBS)
    set(BUILD_STATIC ON CACHE BOOL "" FORCE)
    set(BUILD_PLUGINS_STATIC ON CACHE BOOL "" FORCE)
endif()

# Corrade

set(WITH_INTERCONNECT OFF CACHE BOOL "" FORCE)
set(WITH_TESTSUITE OFF CACHE BOOL "" FORCE)
set(WITH_MAIN ON CACHE BOOL "" FORCE)
set(WITH_UTILITY ON CACHE BOOL "" FORCE)
set(WITH_RC ON CACHE BOOL "" FORCE)
add_subdirectory(corrade EXCLUDE_FROM_ALL)

# Magnum

set(WITH_GLFWAPPLICATION ON CACHE BOOL "" FORCE)
set(WITH_ANYSCENEIMPORTER ON CACHE BOOL "" FORCE)
set(WITH_ANYIMAGEIMPORTER ON CACHE BOOL "" FORCE)
set(WITH_DEBUGTOOLS ON CACHE BOOL "" FORCE)
set(WITH_MESHTOOLS ON CACHE BOOL "" FORCE)
set(WITH_SCENEGRAPH ON CACHE BOOL "" FORCE)
set(WITH_SHADERS ON CACHE BOOL "" FORCE)
set(WITH_TRADE ON CACHE BOOL "" FORCE)
set(WITH_GL ON CACHE BOOL "" FORCE)
if(SHADER_VALIDATION)
    set(WITH_ANYSHADERCONVERTER ON CACHE BOOL "" FORCE)
    set(WITH_SHADERCONVERTER ON CACHE BOOL "" FORCE)
    set(WITH_SHADERTOOLS ON CACHE BOOL "" FORCE)
endif()
add_subdirectory(magnum EXCLUDE_FROM_ALL)

# Magnum plugins

set(WITH_TINYGLTFIMPORTER ON CACHE BOOL "" FORCE)
set(WITH_STBIMAGEIMPORTER ON CACHE BOOL "" FORCE)
if(SHADER_VALIDATION)
    set(WITH_GLSLANGSHADERCONVERTER ON CACHE BOOL "" FORCE)
endif()
add_subdirectory(magnum-plugins EXCLUDE_FROM_ALL)

# Magnum integration

set(IMGUI_DIR "${CMAKE_CURRENT_SOURCE_DIR}/imgui")
set(WITH_IMGUI ON CACHE BOOL "" FORCE)
add_subdirectory(magnum-integration EXCLUDE_FROM_ALL)
